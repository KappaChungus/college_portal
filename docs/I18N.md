# Internationalization (i18n) System

## Overview
The College Portal uses a simple, elegant JavaScript-based i18n system that allows for easy language switching between English and Polish.

## How It Works

### 1. Core Files
- **`app/javascript/i18n.js`**: Main i18n class with translations and logic
- **`app/javascript/application.js`**: Imports and initializes i18n

### 2. Language Storage
- User's language preference is stored in `localStorage` under key `'language'`
- Automatically loads on page refresh
- Persists across sessions

### 3. Available Languages
- **English (en)**: Default language
- **Polish (pl)**: Secondary language

## Usage

### Adding Translations to HTML Elements

Use the `data-i18n` attribute on any HTML element:

```erb
<!-- Simple text translation -->
<h1 data-i18n="dashboard">Dashboard</h1>

<!-- For input placeholders -->
<input type="text" placeholder="Search..." data-i18n="search" data-i18n-attr="placeholder">

<!-- For buttons -->
<button data-i18n="submit">Submit</button>

<!-- In links -->
<%= link_to some_path do %>
  <span data-i18n="petitions">Petitions</span>
<% end %>
```

### Adding New Translations

Edit `app/javascript/i18n.js` and add your keys to both `en` and `pl` sections:

```javascript
translations = {
  en: {
    my_new_key: 'My New Text',
    another_key: 'Another Text'
  },
  pl: {
    my_new_key: 'Mój Nowy Tekst',
    another_key: 'Inny Tekst'
  }
}
```

### Using Translations in JavaScript

```javascript
// Get current language
const currentLang = window.i18n.getCurrentLanguage(); // 'en' or 'pl'

// Translate a key
const translated = window.t('dashboard'); // Returns 'Dashboard' or 'Panel główny'

// Listen for language changes
document.addEventListener('languageChanged', (event) => {
  const newLang = event.detail.language;
  console.log('Language changed to:', newLang);
  // Reload dynamic content or update UI
});
```

### Example: Dynamic Content Translation

When loading content via API, use the translation function:

```javascript
async function loadData() {
  const data = await fetch('/api/endpoint');
  
  // Use translations for dynamic content
  const container = document.getElementById('container');
  container.innerHTML = `
    <h2>${window.t('loading')}</h2>
    <button>${window.t('submit')}</button>
  `;
}

// Reload content when language changes
document.addEventListener('languageChanged', () => {
  loadData();
});
```

## Current Translations

### Navigation
- `dashboard` - Dashboard / Panel główny
- `study_progress` - Study Progress / Postęp studiów
- `schedule` - Schedule / Plan zajęć
- `petitions` - Petitions / Podania
- `surveys` - Surveys / Ankiety

### Common Actions
- `loading` - Loading... / Ładowanie...
- `submit` - Submit / Wyślij
- `cancel` - Cancel / Anuluj
- `save` - Save / Zapisz
- `edit` - Edit / Edytuj
- `delete` - Delete / Usuń
- `close` - Close / Zamknij
- `back` - Back / Powrót

### Header
- `profile` - Profile / Profil
- `logout` - Log Out / Wyloguj
- `hello` - Hello / Witaj

## Best Practices

### 1. Use Semantic Keys
```javascript
// Good
'petitions.title': 'My Petitions'
'petitions.new_button': 'New Petition'

// Avoid
'text1': 'My Petitions'
'btn2': 'New Petition'
```

### 2. Keep Translations Consistent
Ensure the same term is translated the same way throughout the app.

### 3. Handle Dynamic Content
For content loaded via JavaScript, remember to:
- Use `window.t()` function
- Listen to `languageChanged` event
- Reload/update content when language changes

### 4. Test Both Languages
Always test your changes in both English and Polish to ensure:
- All text is translated
- UI doesn't break with longer/shorter text
- Context makes sense in both languages

## Implementation Example

Here's a complete example of a page with i18n:

```erb
<!-- app/views/student_frontend/example.html.erb -->
<div class="container">
  <h1 data-i18n="example.title">Example Page</h1>
  
  <form id="example-form">
    <label data-i18n="example.name_label">Name:</label>
    <input type="text" data-i18n="example.name_placeholder" data-i18n-attr="placeholder" placeholder="Enter your name">
    
    <button type="submit" data-i18n="submit">Submit</button>
    <button type="button" data-i18n="cancel">Cancel</button>
  </form>
  
  <div id="dynamic-content"></div>
</div>

<script>
  // Load dynamic content
  async function loadContent() {
    const data = await fetch('/api/data');
    const container = document.getElementById('dynamic-content');
    
    container.innerHTML = `
      <p>${window.t('example.loaded')}: ${data.count}</p>
      <button onclick="refresh()">${window.t('example.refresh')}</button>
    `;
  }
  
  // Reload when language changes
  document.addEventListener('languageChanged', loadContent);
  
  // Initial load
  loadContent();
</script>
```

Then add to `i18n.js`:

```javascript
en: {
  example: {
    title: 'Example Page',
    name_label: 'Name:',
    name_placeholder: 'Enter your name',
    loaded: 'Loaded',
    refresh: 'Refresh'
  }
},
pl: {
  example: {
    title: 'Przykładowa Strona',
    name_label: 'Imię:',
    name_placeholder: 'Wprowadź swoje imię',
    loaded: 'Załadowano',
    refresh: 'Odśwież'
  }
}
```

## Troubleshooting

### Translations not updating
1. Check browser console for errors
2. Ensure `data-i18n` attribute is correctly set
3. Verify the key exists in both `en` and `pl` translations
4. Clear browser cache and reload

### Dynamic content not translating
1. Ensure you're using `window.t()` function
2. Add event listener for `languageChanged`
3. Reload/update content when language changes

### Missing translations
If a translation key doesn't exist, the system will:
1. Fall back to English translation
2. If English also missing, display the key itself
